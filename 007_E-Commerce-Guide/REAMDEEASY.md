## EasyExcel

### 一、初识EasyExcel

#### 1.Apache POl

先说PoI，有过报表导入导出经验的同学，应该听过或者使用。
Apache PoI是Apache软件基金会的开源函式库，提供跨平台的Java API实现Microsoft office格式档案读写。但是存在如下一些问题:

**1.1 学习使用成本较高**

对POI有过深入了解的才知道原来POl还有SAX模式(Dom解析模式)。但SAX模式相对比较复杂，excel有03和07两种版本，两个版本数据存储方式截然不同，sax解析方式也各不一样

想要了解清楚这两种解析方式，才去写代码测试，估计两天时间是需要的。再加上即使解析完，要转换到自己业务模型还要很多繁琐的代码。总体下来感觉至少需要三天，由于代码复杂，后续维护成本巨大

POI的SAX模式的API可以一定程度的解决一些内存溢出的问题，但是POI还是有一些缺陷，比如07版Excel解压缩以及解压后存储都是在内存中完成的，内存消耗依然很大，一个3M的Excel用POI的SAX解析，依然需要100M左右内存

**1.2 POI的内存消耗较大**

大部分使用POI都是使用他的userModel模式。userModel的好处是上手容易使用简单，随便拷贝个代码跑一下，剩下就是写业务转换了，虽然转换也要写上百行代码，相对比较好理解。然而userModel模式最大的问题是在于非常大的内存消耗，一个几兆的文件解析要用掉上百兆的内存。现在很多应用采用这种模式，之所以还正常在跑一定是并发不大，并发上来后一定会OOM或者频繁的full gc

总体上来说，简单写法重度依赖内存，复杂写法学习成本高

**POI特点**

```sh
        1.功能强大
        2.代码书写冗余繁杂
        3.读写大文件耗费内存较大，容易OOM
```

### 2.EasyExcel

**2.1重写了POl对07版Excel的解析**

- EasyExcel重写了POI对07版Excel的解析，可以把内存消耗从100M左右降低到10MI以内，并且再大的Excel不会出现内存溢出，03版仍依赖POI的SAX模式

- 下图为64M内存1分钟内读取75M(46W行25列)的Excel (当然还有急速模式能更快，但是内存占用会在100M多—点)





- 在上层做了模型转换的封装，让使用者更加简单方便

**特点**

```sh
1.在数据模型层面进行了封装，使用简单
⒉重写了07版本的Excel的解析代码，降低内存消耗，能有效避免OOM
3.只能操作Excel
4.不能读取图片

使用程序读写excel，数据在excel文件、程序<实体类、Map>这两个载体中间相互流转
优雅编程lombok
```